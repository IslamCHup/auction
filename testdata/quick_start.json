{
    "info": {
        "name": "Auction Service - Quick Start",
        "description": "Быстрые тесты для проверки основных эндпойнтов"
    },
    "item": [
        {
            "name": "1. Register Buyer",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "if (pm.response.code === 201) {",
                            "    var jsonData = pm.response.json();",
                            "    pm.environment.set('jwt_token', jsonData.token);",
                            "    pm.environment.set('buyer_id', jsonData.user.id);",
                            "}"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"email\": \"buyer@example.com\",\n  \"password\": \"password123\",\n  \"role\": \"buyer\"\n}"
                },
                "url": {
                    "raw": "{{base_url_gateway}}/api/auth/register",
                    "host": [
                        "{{base_url_gateway}}"
                    ],
                    "path": [
                        "api",
                        "auth",
                        "register"
                    ]
                }
            }
        },
        {
            "name": "2. Register Seller",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"email\": \"seller@example.com\",\n  \"password\": \"password123\",\n  \"role\": \"seller\"\n}"
                },
                "url": {
                    "raw": "{{base_url_gateway}}/api/auth/register",
                    "host": [
                        "{{base_url_gateway}}"
                    ],
                    "path": [
                        "api",
                        "auth",
                        "register"
                    ]
                }
            }
        },
        {
            "name": "3. Deposit Money",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "X-User-Id",
                        "value": "{{buyer_id}}"
                    },
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"amount\": 5000,\n  \"description\": \"Initial deposit for bidding\"\n}"
                },
                "url": {
                    "raw": "{{base_url_wallet}}/api/wallet/deposit",
                    "host": [
                        "{{base_url_wallet}}"
                    ],
                    "path": [
                        "api",
                        "wallet",
                        "deposit"
                    ]
                }
            }
        },
        {
            "name": "4. Create Lot",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "if (pm.response.code === 200) {",
                            "    pm.environment.set('lot_id', 1);",
                            "}"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"title\": \"iPhone 15 Pro\",\n  \"description\": \"Latest iPhone 15 Pro, 256GB, Black\",\n  \"starting_price\": 999,\n  \"seller_id\": {{seller_id}},\n  \"ends_at\": \"2026-01-25T18:00:00Z\"\n}"
                },
                "url": {
                    "raw": "{{base_url_auction}}/api/lots",
                    "host": [
                        "{{base_url_auction}}"
                    ],
                    "path": [
                        "api",
                        "lots"
                    ]
                }
            }
        },
        {
            "name": "5. Get All Lots",
            "request": {
                "method": "GET",
                "header": [],
                "url": {
                    "raw": "{{base_url_auction}}/api/lots?page=1&limit=10&status=active",
                    "host": [
                        "{{base_url_auction}}"
                    ],
                    "path": [
                        "api",
                        "lots"
                    ],
                    "query": [
                        {
                            "key": "page",
                            "value": "1"
                        },
                        {
                            "key": "limit",
                            "value": "10"
                        },
                        {
                            "key": "status",
                            "value": "active"
                        }
                    ]
                }
            }
        },
        {
            "name": "6. Create Bid",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "if (pm.response.code === 201) {",
                            "    pm.environment.set('bid_id', 1);",
                            "    console.log('Bid created successfully');",
                            "}"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"amount\": 1100,\n  \"bidder_id\": {{buyer_id}}\n}"
                },
                "url": {
                    "raw": "{{base_url_auction}}/api/lots/{{lot_id}}/bids",
                    "host": [
                        "{{base_url_auction}}"
                    ],
                    "path": [
                        "api",
                        "lots",
                        "{{lot_id}}",
                        "bids"
                    ]
                }
            }
        },
        {
            "name": "7. Get Bids for Lot",
            "request": {
                "method": "GET",
                "header": [],
                "url": {
                    "raw": "{{base_url_auction}}/api/lots/{{lot_id}}/bids",
                    "host": [
                        "{{base_url_auction}}"
                    ],
                    "path": [
                        "api",
                        "lots",
                        "{{lot_id}}",
                        "bids"
                    ]
                }
            }
        },
        {
            "name": "8. Check Wallet",
            "request": {
                "method": "GET",
                "header": [
                    {
                        "key": "X-User-Id",
                        "value": "{{buyer_id}}"
                    }
                ],
                "url": {
                    "raw": "{{base_url_wallet}}/api/wallet",
                    "host": [
                        "{{base_url_wallet}}"
                    ],
                    "path": [
                        "api",
                        "wallet"
                    ]
                }
            }
        }
    ]
}